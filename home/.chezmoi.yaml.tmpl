{{/* File use to customize the chezmoi config file when doing a `chezmoi init`. */}}
{{/* Use template or trigger prompts to populate values. */}}

{{- /* Default values */ -}}
{{- $private  := false -}} {{/* true if this machine should have private secrets */}}
{{- $installZSH := true -}}
{{- $changeShell := true -}}
{{- $work := false -}}{{/* true if this machine is a work machine */}}
{{- $ephemeral := false -}}{{/* true if this machine is ephemeral, e.g. a cloud or VM instance */}}
{{- $headless := false -}}{{/* true if this machine does not have a screen and keyboard */}}
{{- $interactive := stdinIsATTY -}}{{/* chezmoiinit functions who returns true if chezmoi's standard input is a TTY */}}
{{- $debug_hooks := false -}}{{/* Add debug print for hook */}}


{{- /* Prompts */ -}}
{{- writeToStdout (printf "\n⮞  chezmoi':' host configuration\n") -}}
{{- writeToStdout (printf "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\n") -}}
{{- $private  := promptBool "  ?  Enable Private mode on this machine (install bitwarden_cli and populate secrets) ? (yes/no)" -}}
{{- writeToStdout (printf "    ➜ Answer '%s' \n" $private ) -}}
{{- $tag_choices := list "homelab" "dev" "personal" "work" -}}
{{- $tags := promptMultichoice "  ?  Tags list for this machine (e.g., dev, homelab, work)" $tag_choices (list "dev") -}}
{{- writeToStdout (printf "    ➜ Answer '%s' \n" $tags ) -}}


{{- /* OS infos */ -}}
{{- $OS_ID := .chezmoi.os -}}
{{- if (and (eq .chezmoi.os "linux") (hasKey .chezmoi.osRelease "id")) -}}
{{-   $OS_ID = printf "%s-%s" .chezmoi.os .chezmoi.osRelease.id -}}
{{- end -}}

{{- $is_WSL := false -}}
{{- if eq .chezmoi.os "linux" -}}
{{-   if (.chezmoi.kernel.osrelease | lower | contains "microsoft") -}}
{{-     $is_WSL = true -}}
{{-   end -}}
{{- end -}}


{{- /* Hook commands */ -}}
hooks:
  init:
    pre:
      script: {{ .chezmoi.workingTree }}/home/.chezmoihooks/hook-init-pre_header.sh
{{ if $private }}
  read-source-state:
    pre:
      script: {{ .chezmoi.workingTree }}/home/.chezmoihooks/install-password-manager.sh
{{ end }}


{{- /* Data */ -}}
data:
  name: "phenates"
  email: "phen4tes@gmail.com"
  OS_id: {{ $OS_ID | quote }}
  is_WSL: {{ $is_WSL }}
  signingKey: ""
  private: {{ $private  }}
  installZSH: {{ $installZSH }}
  changeShell: {{ $changeShell }}
  tags: {{ $tags | toToml }}

edit:
  command: "nano"

bitwarden:
  unlock: "auto"

git:
  autoCommit: true
  autoPush: true

